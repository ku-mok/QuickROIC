{"version":3,"sources":["theme.tsx","page/hooks/useTabItems.ts","organisms/Header.tsx","atom/Loading.tsx","atom/ErrorSnack.tsx","template/Template.tsx","store.ts","page/Home.tsx","atom/UploadButton.tsx","molecules/UploadArea.tsx","organisms/FileUploader.tsx","generated/graphql.ts","page/NewFile.tsx","page/hooks/useModal.ts","page/hooks/useRoicWacc.ts","util/dataTransform.ts","organisms/ColumnFilterModal.tsx","page/Table.tsx","util/createCsvString.ts","page/Scatter.tsx","page/hooks/useIntervalFunc.ts","page/Tree.tsx","organisms/CompanySetting.tsx","page/Setting.tsx","page/hooks/useCompanySettings.ts","App.tsx","reportWebVitals.ts","index.tsx"],"names":["theme","createTheme","useTabItems","isDataLoaded","history","useHistory","tabItems","useMemo","label","onClick","push","disabled","Header","props","AppBar","position","Toolbar","Typography","variant","children","Paper","Tabs","value","tabSelected","map","tab","Tab","Loading","Backdrop","sx","color","zIndex","drawer","open","CircularProgress","ErrorSnack","Alert","forwardRef","ref","elevation","useState","error","setOpen","handleClose","event","reason","Snackbar","onClose","severity","width","message","ContentContainer","styled","div","Template","loading","localCompanyDataVar","makeVar","isDataLoadedVar","companySettingVar","typePolicies","Query","fields","localCompanyData","read","typeDefs","gql","Home","useReactiveVar","component","href","target","rel","UploadButton","Button","successText","errorText","disable","handleButtonClick","fullWidth","size","StyledPaper","GuideText","UploadArea","useDropzone","accept","onDropAccepted","files","setAcceptedFiles","getRootProps","getInputProps","rootProps","data-testid","acceptedFiles","length","f","name","FileUploader","handleUpload","UploadExcelDocument","GetLocalDataDocument","CalcRoicWaccDocument","NewFilePres","NewFile","useMutation","onCompleted","data","localData","uploadSpeedaExcel","companyData","d","__typename","others","metrics","othersMetrics","colors","Set","companyName","i","visibility","console","info","window","setTimeout","onError","uploadFunc","a","variables","c","undefined","useModal","modalOpen","setModalOpen","handleModalOpen","handleModalClose","useRoicWacc","onComplete","setData","useQuery","queryResponse","refetchRoic","prevData","calcRoic","calcDrivers","sort","b","err","refetch","toTableColumn","filter","columns","metricsName","key","x","includes","toScatterData","y","yearIndex","companyColor","companies","xAxisData","reduce","prev","current","set","metricsValues","Map","yAxisData","company","get","type","mode","text","textposition","marker","ModalContent","FlexContainer","ColumnFilterModal","handleAllUncheck","useCallback","handleFilterChange","handleAllCheck","Modal","List","col","ListItem","e","ListItemIcon","CheckBoxOutlineBlank","CheckBox","ListItemText","primary","ButtonContainer","Table","setExpandedGroupIds","tableData","expandedGroupIds","rows","yearCompanyMap","flatMap","metricsYears","year","JSON","stringify","t","forEach","row","Object","assign","yearCompanyName","parse","企業名称","年度","toTableRow","allColumns","columnFilter","setColumnFilter","filteredColumns","column","startIcon","PermDataSetting","Save","csvString","join","slice","createCsvString","bom","Uint8Array","blob","Blob","url","URL","createObjectURL","document","createElement","download","click","remove","style","height","groupBy","rowGrouper","className","onExpandedGroupIdsChange","defaultColumnOptions","resizable","Scatter","setYearIndex","func","interval","isActive","setIsActive","intervalId","setIntervalId","startInterval","id","setInterval","stopInterval","clearInterval","toggleInterval","useIntervalFunc","isYearMoving","companySetting","setting","companyVisibility","roicWaccData","nopatCapitalData","gridSx","display","justifyContent","Grid","container","item","md","sm","layout","showlegend","title","xaxis","rangemode","tickformat","yaxis","shapes","x0","y0","x1","y1","xref","yref","line","dash","columnGap","alignItems","ToggleButtonGroup","ToggleButton","IconButton","Stop","PlayArrow","Tree","roicData","metrics_position","ROIC","投下資本回転率","NOPATマージン","固定資産回転率","運転資本回転率","販管費率","売上原価率","legendgroup","toTreeData","annotations","showarrow","align","domain","anchor","xaxis2","xaxis3","yaxis2","yaxis3","yaxis4","yaxis5","yaxis6","yaxis7","legend","orientation","config","responsive","CompanySetting","setColor","focusedCompanyIndex","setFocusedCompanyIndex","Chip","onDelete","setVisibility","deleteIcon","Visibility","VisibilityOff","background","hexColor","parseInt","substr","top","left","transform","onChange","_","hex","Setting","companySettings","index","useCompanySettings","Providers","basename","process","StyledEngineProvider","injectFirst","routing","path","App","r","exact","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","link","createUploadLink","uri","client","ApolloClient","cache","InMemoryCache","ReactDOM","render","StrictMode","ApolloProvider","getElementById"],"mappings":"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","file":"static/js/main.011e2d7a.chunk.js","sourcesContent":["import { createTheme } from \"@mui/material/styles\";\n\nconst theme = createTheme({});\n\nexport default theme;\n","import { useMemo } from \"react\";\nimport { useHistory } from \"react-router\";\nimport { HeaderProps } from \"../../organisms/Header\";\nexport const useTabItems = (isDataLoaded = true): HeaderProps[\"tabItems\"] => {\n  const history = useHistory();\n  const tabItems = useMemo<HeaderProps[\"tabItems\"]>(\n    () => [\n      {\n        label: \"Home\",\n        onClick: () => history.push(\"/\"),\n      },\n      {\n        label: \"新規分析\",\n        onClick: () => history.push(\"/new\"),\n      },\n      {\n        label: \"データ確認\",\n        onClick: () => history.push(\"/table\"),\n        disabled: !isDataLoaded,\n      },\n      {\n        label: \"ROIC-WACCグラフ\",\n        onClick: () => history.push(\"/scatter\"),\n        disabled: !isDataLoaded,\n      },\n      {\n        label: \"ROICツリー\",\n        onClick: () => history.push(\"/tree\"),\n        disabled: !isDataLoaded,\n      },\n      {\n        label: \"表示設定\",\n        onClick: () => history.push(\"/setting\"),\n        disabled: !isDataLoaded,\n      },\n    ],\n    [history, isDataLoaded]\n  );\n  return tabItems;\n};\n","import React from \"react\";\nimport { AppBar, Paper, Tab, Tabs, Toolbar, Typography } from \"@mui/material\";\nimport { useHistory } from \"react-router\";\n\nexport type HeaderProps = {\n  children: React.ReactText;\n  tabItems: {\n    label: string;\n    onClick: () => void;\n    disabled?: boolean;\n  }[];\n  tabSelected: number;\n};\nconst Header: React.FC<HeaderProps> = (props) => {\n  const history = useHistory();\n  const handleTitleClick = () => {\n    history.push(\"/\");\n  };\n  return (\n    <>\n      <AppBar position=\"sticky\">\n        <Toolbar>\n          <Typography variant=\"h5\" onClick={handleTitleClick}>\n            {props.children}\n          </Typography>\n        </Toolbar>\n      </AppBar>\n      <Paper>\n        <Tabs value={props.tabSelected}>\n          {props.tabItems.map((tab) => (\n            <Tab\n              key={tab.label}\n              label={tab.label}\n              disabled={tab.disabled}\n              onClick={tab.onClick}\n            />\n          ))}\n        </Tabs>\n      </Paper>\n    </>\n  );\n};\n\nexport default Header;\n","import Backdrop from \"@mui/material/Backdrop\";\nimport CircularProgress from \"@mui/material/CircularProgress\";\n\nconst Loading: React.FC = () => {\n  return (\n    <Backdrop\n      sx={{ color: \"#fff\", zIndex: (theme) => theme.zIndex.drawer + 1 }}\n      open={true}\n    >\n      <CircularProgress color=\"inherit\" />\n    </Backdrop>\n  );\n};\nexport default Loading;\n","import Snackbar from \"@mui/material/Snackbar\";\nimport MuiAlert, { AlertProps } from \"@mui/material/Alert\";\nimport { forwardRef, useState } from \"react\";\nimport { ApolloError } from \"@apollo/client\";\n\nconst ErrorSnack: React.FC<{ error?: ApolloError }> = (props) => {\n  const Alert = forwardRef<HTMLDivElement, AlertProps>(function Alert(\n    props,\n    ref\n  ) {\n    return <MuiAlert elevation={6} ref={ref} variant=\"filled\" {...props} />;\n  });\n  const [open, setOpen] = useState(!!props.error);\n\n  const handleClose = (event?: React.SyntheticEvent, reason?: string) => {\n    if (reason === \"clickaway\") {\n      return;\n    }\n    setOpen(false);\n  };\n  return (\n    <Snackbar open={open} onClose={handleClose}>\n      <Alert onClose={handleClose} severity=\"error\" sx={{ width: \"100%\" }}>\n        {props.error?.message}\n      </Alert>\n    </Snackbar>\n  );\n};\nexport default ErrorSnack;\n","import Header from \"../organisms/Header\";\nimport styled from \"styled-components\";\nimport { ApolloError } from \"@apollo/client\";\nimport Loading from \"../atom/Loading\";\nimport ErrorSnack from \"../atom/ErrorSnack\";\n\nconst ContentContainer = styled.div`\n  margin-top: 1ex;\n  margin-left: 1vw;\n  margin-right: 3vw;\n`;\nexport type TemplateProps = {\n  children: React.ReactNode;\n  tabItems: {\n    label: string;\n    onClick: () => void;\n    disabled?: boolean;\n  }[];\n  tabSelected: number;\n  loading?: boolean;\n  error?: ApolloError;\n};\nconst Template: React.FC<TemplateProps> = (props) => {\n  return (\n    <>\n      {props.loading && <Loading />}\n      {props.error && <ErrorSnack error={props.error} />}\n      <Header tabItems={props.tabItems} tabSelected={props.tabSelected}>\n        QuickRoic\n      </Header>\n      <ContentContainer>{props.children}</ContentContainer>\n    </>\n  );\n};\n\nexport default Template;\n","import { makeVar, TypePolicies } from \"@apollo/client\";\nimport { CompanyData } from \"./generated/graphql\";\nimport { gql } from \"graphql-tag\";\n\nexport const localCompanyDataVar = makeVar<CompanyData[]>([]);\nexport const isDataLoadedVar = makeVar(false);\nexport const companySettingVar = makeVar<\n  { name: string; color: string; visibility: boolean }[]\n>([]);\nexport const typePolicies: TypePolicies = {\n  Query: {\n    fields: {\n      localCompanyData: {\n        read() {\n          return localCompanyDataVar();\n        },\n      },\n    },\n  },\n};\nexport const typeDefs = gql`\n  extend type Query {\n    localCompanyData: [CompanyData!]!\n  }\n`;\n","import { Typography } from \"@mui/material\";\nimport { useTabItems } from \"./hooks/useTabItems\";\nimport Template from \"../template/Template\";\nimport { useReactiveVar } from \"@apollo/client\";\nimport { isDataLoadedVar } from \"../store\";\n\nconst Home: React.FC = () => {\n  const isDataLoaded = useReactiveVar(isDataLoadedVar);\n  const tabItems = useTabItems(isDataLoaded);\n  return (\n    <Template tabItems={tabItems} tabSelected={0}>\n      <Typography variant=\"h4\" component=\"h2\">\n        QuickRoicとは\n      </Typography>\n      <p>\n        SPEEDAからダウンロードしたデータを元にROIC分析を簡単に行うためのツールです。ブラウザ上でROICツリーなどの分析結果を確認できるだけでなく、分析結果をダウンロードして資料に使ったり、CSVで出力してローカルでさらなる分析を行うことも可能です\n      </p>\n      <Typography variant=\"h4\" component=\"h2\">\n        使い方\n      </Typography>\n      <ol>\n        <li>\n          <dl>\n            <dt>SPEEDAからデータをダウンロードする</dt>\n            <dd>\n              SPEEDAの「企業を探す」機能を用いてデータをダウンロードします。検索条件を指定して検索を実行→ダウンロードでエクセルをダウンロードできます。ROIC分析を行うために必要な勘定科目は\n              「売上高合計」 「投下資本」 「現金及び現金同等物」 「NOPAT」\n              「販売費及び一般管理費」 「売上原価」 「売上債権」 「棚卸資産」\n              「買入債務」 「固定資産」 「Levered β(任意の期間、\n              直近3年(週次)あたりを推奨）」 「有利子負債残高」\n              「支払利息割引料」 「企業価値」\n              「時価総額(自己株式調整後)」です。検索条件を指定した状態のURLは{\" \"}\n              <a\n                href=\"https://www.ub-speeda.com/search/company/searchcompany/path/11b51eac-9ff8-48b4-9969-debc582e9077\"\n                target=\"_blank\"\n                rel=\"noreferrer\"\n              >\n                その1\n              </a>\n              および\n              <a\n                href=\"https://www.ub-speeda.com/search/company/searchcompany/path/071a9639-05b2-44f3-ab73-abafbbe9074e\"\n                target=\"_blank\"\n                rel=\"noreferrer\"\n              >\n                その2\n              </a>\n              です。エラーが出る場合は一度SPEEDAにログインしなおしてください。SPEEDAの仕様上年度×勘定科目数が100に制限されているため、2つに分かれています。また、B/S系の指標は平残を用いて計算するため、開始期間は分析したい開始年度-1を指定してください。LTMにチェックを入れてください（βを求めるため）。\n            </dd>\n          </dl>\n        </li>\n        <li>\n          <dt>データをアップロードする</dt>\n          <dd>\n            新規分析タブをクリックし、「分析対象のファイルを～」と書かれた領域に先ほどダウンロードしたエクセルをドラッグアンドドロップするもしくはクリックして表示されたウィンドウで選択します。その後「アップロードして分析を実施」を押下します。うまくいけばデータ確認画面に遷移します\n          </dd>\n        </li>\n        <li>\n          <dt>データを確認する</dt>\n          <dd>\n            データ確認タブでは生データを確認できます。DOWNLOAD AS\n            CSVをクリックすることでCSVでダウンロードすることができます。\n          </dd>\n        </li>\n        <li>\n          <dt>各種グラフを確認する</dt>\n          <dd>\n            ROIC-WACCグラフおよびROICツリータブで分析結果を確認できます。グラフにカーソルを合わせて右上に出てくるカメラマークをクリックすると画像でグラフをダウンロードすることもできます\n          </dd>\n        </li>\n        <li>\n          <dt>企業の表示設定を行う</dt>\n          <dd>\n            色を変えたい、企業をフィルタしたいなどの場合は表示設定タブを使います。企業名をクリックすると色を変更できます。企業名右の目アイコンをクリックすると表示・非表示を切り替えます。\n          </dd>\n        </li>\n      </ol>\n    </Template>\n  );\n};\n\nexport default Home;\n","import { Button, ButtonProps, CircularProgress } from \"@mui/material\";\n\nexport type UploadButtonProps = {\n  disable: boolean;\n  loading?: boolean;\n  successText?: string;\n  errorText?: string;\n  handleButtonClick: ButtonProps[\"onClick\"];\n};\n\nconst UploadButton: React.FC<UploadButtonProps> = (props) => (\n  <>\n    <Button\n      variant=\"contained\"\n      color={\n        props.successText ? \"success\" : props.errorText ? \"error\" : \"primary\"\n      }\n      disabled={props.disable || props.loading}\n      onClick={props.handleButtonClick}\n      fullWidth\n    >\n      {props.loading && <CircularProgress size={24} />}\n      {!props.loading &&\n        !props.successText &&\n        !props.errorText &&\n        props.children}\n      {props.successText}\n      {props.errorText}\n    </Button>\n  </>\n);\n\nexport default UploadButton;\n","import { useDropzone } from \"react-dropzone\";\nimport { Paper } from \"@mui/material\";\nimport styled from \"styled-components\";\nexport type UploadAreaProps = {\n  acceptedFiles: File[];\n  setAcceptedFiles: (files: File[]) => void;\n};\n\nconst StyledPaper = styled(Paper)`\n  height: 50vh;\n  margin: 1ex auto;\n`;\nconst GuideText = styled.div`\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  height: 100%;\n`;\nconst UploadArea: React.FC<UploadAreaProps> = (props) => {\n  const { getRootProps, getInputProps } = useDropzone({\n    accept: \".xlsx\",\n    onDropAccepted: (files: File[]) => props.setAcceptedFiles(files),\n  });\n  const { ref, ...rootProps } = getRootProps();\n  return (\n    <div ref={ref}>\n      <StyledPaper {...rootProps} elevation={3}>\n        <input {...getInputProps()} data-testid=\"dropzone\" />\n        {props.acceptedFiles.length === 0 ? (\n          <GuideText>\n            分析対象のファイルをドラッグアンドドロップするかクリックして選択してください\n          </GuideText>\n        ) : (\n          <GuideText>\n            <ol>\n              {props.acceptedFiles.map((f) => (\n                <li key={f.name}>{f.name}</li>\n              ))}\n            </ol>\n          </GuideText>\n        )}\n      </StyledPaper>\n    </div>\n  );\n};\nexport default UploadArea;\n","import React from \"react\";\nimport UploadButton from \"../atom/UploadButton\";\nimport UploadArea from \"../molecules/UploadArea\";\n\nexport type FileUploaderProps = {\n  acceptedFiles: File[];\n  setAcceptedFiles: (files: File[]) => void;\n  handleUpload: () => void;\n  successText?: string;\n  errorText?: string;\n  loading: boolean;\n};\n\nconst FileUploader: React.FC<FileUploaderProps> = (props) => {\n  return (\n    <>\n      <UploadArea\n        acceptedFiles={props.acceptedFiles}\n        setAcceptedFiles={props.setAcceptedFiles}\n      />\n      <UploadButton\n        successText={props.successText}\n        errorText={props.errorText}\n        loading={props.loading}\n        disable={props.acceptedFiles.length === 0}\n        handleButtonClick={props.handleUpload}\n      >\n        アップロードして分析を実施\n      </UploadButton>\n    </>\n  );\n};\nexport default FileUploader;\n","import { TypedDocumentNode as DocumentNode } from '@graphql-typed-document-node/core';\nexport type Maybe<T> = T | null;\nexport type Exact<T extends { [key: string]: unknown }> = { [K in keyof T]: T[K] };\nexport type MakeOptional<T, K extends keyof T> = Omit<T, K> & { [SubKey in K]?: Maybe<T[SubKey]> };\nexport type MakeMaybe<T, K extends keyof T> = Omit<T, K> & { [SubKey in K]: Maybe<T[SubKey]> };\n/** All built-in and custom scalars, mapped to their actual values */\nexport type Scalars = {\n  ID: string;\n  String: string;\n  Boolean: boolean;\n  Int: number;\n  Float: number;\n  MetricsValue: any;\n  /**\n   * Create scalar that ignores normal serialization/deserialization, since\n   * that will be handled by the multipart request spec\n   */\n  Upload: any;\n};\n\n/** 企業のデータを表す型で企業名称とMetricsの配列を持つ */\nexport type CompanyData = {\n  __typename?: 'CompanyData';\n  companyName: Scalars['String'];\n  metrics: Metrics;\n};\n\n/** 企業のデータを表す型で企業名称とMetricsの配列を持つ */\nexport type CompanyDataInput = {\n  companyName: Scalars['String'];\n  metrics: MetricsInput;\n};\n\nexport type FileUploadMutation = {\n  __typename?: 'FileUploadMutation';\n  companyData: Array<CompanyData>;\n  ok?: Maybe<Scalars['Boolean']>;\n};\n\n/** 財務指標を表す型で年度・指標名称・値を持つ */\nexport type Metrics = {\n  __typename?: 'Metrics';\n  metricsName: Scalars['String'];\n  metricsValues: Array<Scalars['MetricsValue']>;\n  metricsYears: Array<Scalars['Int']>;\n};\n\n/** 財務指標を表す型で年度・指標名称・値を持つ */\nexport type MetricsInput = {\n  metricsName: Scalars['String'];\n  metricsValues: Array<Scalars['MetricsValue']>;\n  metricsYears: Array<Scalars['Int']>;\n};\n\nexport type Mutation = {\n  __typename?: 'Mutation';\n  uploadSpeedaExcel?: Maybe<FileUploadMutation>;\n};\n\n\nexport type MutationUploadSpeedaExcelArgs = {\n  files?: Maybe<Array<Maybe<Scalars['Upload']>>>;\n};\n\nexport type Query = {\n  __typename?: 'Query';\n  /** ROICドライバ計算を行うクエリ。dataに計算を行うデータを渡し、metricsに必要なカラムを指定する。デフォルト値（空配列）の場合すべてのカラムが帰る */\n  calcDrivers: Array<CompanyData>;\n  /** ROIC計算を行うクエリ。dataに計算を行うデータを渡し、metricsに必要なカラムを指定する。デフォルト値（空配列）の場合すべてのカラムが帰る */\n  calcRoic: Array<CompanyData>;\n  localCompanyData: Array<CompanyData>;\n};\n\n\nexport type QueryCalcDriversArgs = {\n  data?: Maybe<Array<Maybe<CompanyDataInput>>>;\n  metrics?: Maybe<Array<Maybe<Scalars['String']>>>;\n};\n\n\nexport type QueryCalcRoicArgs = {\n  data?: Maybe<Array<Maybe<CompanyDataInput>>>;\n  metrics?: Maybe<Array<Maybe<Scalars['String']>>>;\n};\n\nexport type UploadExcelMutationVariables = Exact<{\n  files: Array<Scalars['Upload']> | Scalars['Upload'];\n}>;\n\n\nexport type UploadExcelMutation = { __typename?: 'Mutation', uploadSpeedaExcel?: Maybe<{ __typename?: 'FileUploadMutation', companyData: Array<{ __typename?: 'CompanyData', companyName: string, metrics: { __typename?: 'Metrics', metricsName: string, metricsValues: Array<any>, metricsYears: Array<number> } }> }> };\n\nexport type GetLocalDataQueryVariables = Exact<{ [key: string]: never; }>;\n\n\nexport type GetLocalDataQuery = { __typename?: 'Query', localCompanyData: Array<{ __typename?: 'CompanyData', companyName: string, metrics: { __typename?: 'Metrics', metricsName: string, metricsValues: Array<any>, metricsYears: Array<number> } }> };\n\nexport type CalcRoicWaccQueryVariables = Exact<{\n  data?: Maybe<Array<Maybe<CompanyDataInput>> | Maybe<CompanyDataInput>>;\n}>;\n\n\nexport type CalcRoicWaccQuery = { __typename?: 'Query', calcDrivers: Array<{ __typename?: 'CompanyData', companyName: string, metrics: { __typename?: 'Metrics', metricsName: string, metricsValues: Array<any>, metricsYears: Array<number> } }>, calcRoic: Array<{ __typename?: 'CompanyData', companyName: string, metrics: { __typename?: 'Metrics', metricsName: string, metricsValues: Array<any>, metricsYears: Array<number> } }> };\n\n\nexport const UploadExcelDocument = {\"kind\":\"Document\",\"definitions\":[{\"kind\":\"OperationDefinition\",\"operation\":\"mutation\",\"name\":{\"kind\":\"Name\",\"value\":\"UploadExcel\"},\"variableDefinitions\":[{\"kind\":\"VariableDefinition\",\"variable\":{\"kind\":\"Variable\",\"name\":{\"kind\":\"Name\",\"value\":\"files\"}},\"type\":{\"kind\":\"NonNullType\",\"type\":{\"kind\":\"ListType\",\"type\":{\"kind\":\"NonNullType\",\"type\":{\"kind\":\"NamedType\",\"name\":{\"kind\":\"Name\",\"value\":\"Upload\"}}}}}}],\"selectionSet\":{\"kind\":\"SelectionSet\",\"selections\":[{\"kind\":\"Field\",\"name\":{\"kind\":\"Name\",\"value\":\"uploadSpeedaExcel\"},\"arguments\":[{\"kind\":\"Argument\",\"name\":{\"kind\":\"Name\",\"value\":\"files\"},\"value\":{\"kind\":\"Variable\",\"name\":{\"kind\":\"Name\",\"value\":\"files\"}}}],\"selectionSet\":{\"kind\":\"SelectionSet\",\"selections\":[{\"kind\":\"Field\",\"name\":{\"kind\":\"Name\",\"value\":\"companyData\"},\"selectionSet\":{\"kind\":\"SelectionSet\",\"selections\":[{\"kind\":\"Field\",\"name\":{\"kind\":\"Name\",\"value\":\"companyName\"}},{\"kind\":\"Field\",\"name\":{\"kind\":\"Name\",\"value\":\"metrics\"},\"selectionSet\":{\"kind\":\"SelectionSet\",\"selections\":[{\"kind\":\"Field\",\"name\":{\"kind\":\"Name\",\"value\":\"metricsName\"}},{\"kind\":\"Field\",\"name\":{\"kind\":\"Name\",\"value\":\"metricsValues\"}},{\"kind\":\"Field\",\"name\":{\"kind\":\"Name\",\"value\":\"metricsYears\"}}]}}]}}]}}]}}]} as unknown as DocumentNode<UploadExcelMutation, UploadExcelMutationVariables>;\nexport const GetLocalDataDocument = {\"kind\":\"Document\",\"definitions\":[{\"kind\":\"OperationDefinition\",\"operation\":\"query\",\"name\":{\"kind\":\"Name\",\"value\":\"GetLocalData\"},\"selectionSet\":{\"kind\":\"SelectionSet\",\"selections\":[{\"kind\":\"Field\",\"name\":{\"kind\":\"Name\",\"value\":\"localCompanyData\"},\"directives\":[{\"kind\":\"Directive\",\"name\":{\"kind\":\"Name\",\"value\":\"client\"}}],\"selectionSet\":{\"kind\":\"SelectionSet\",\"selections\":[{\"kind\":\"Field\",\"name\":{\"kind\":\"Name\",\"value\":\"companyName\"}},{\"kind\":\"Field\",\"name\":{\"kind\":\"Name\",\"value\":\"metrics\"},\"selectionSet\":{\"kind\":\"SelectionSet\",\"selections\":[{\"kind\":\"Field\",\"name\":{\"kind\":\"Name\",\"value\":\"metricsName\"}},{\"kind\":\"Field\",\"name\":{\"kind\":\"Name\",\"value\":\"metricsValues\"}},{\"kind\":\"Field\",\"name\":{\"kind\":\"Name\",\"value\":\"metricsYears\"}}]}}]}}]}}]} as unknown as DocumentNode<GetLocalDataQuery, GetLocalDataQueryVariables>;\nexport const CalcRoicWaccDocument = {\"kind\":\"Document\",\"definitions\":[{\"kind\":\"OperationDefinition\",\"operation\":\"query\",\"name\":{\"kind\":\"Name\",\"value\":\"calcRoicWacc\"},\"variableDefinitions\":[{\"kind\":\"VariableDefinition\",\"variable\":{\"kind\":\"Variable\",\"name\":{\"kind\":\"Name\",\"value\":\"data\"}},\"type\":{\"kind\":\"ListType\",\"type\":{\"kind\":\"NamedType\",\"name\":{\"kind\":\"Name\",\"value\":\"CompanyDataInput\"}}}}],\"selectionSet\":{\"kind\":\"SelectionSet\",\"selections\":[{\"kind\":\"Field\",\"name\":{\"kind\":\"Name\",\"value\":\"calcDrivers\"},\"arguments\":[{\"kind\":\"Argument\",\"name\":{\"kind\":\"Name\",\"value\":\"data\"},\"value\":{\"kind\":\"Variable\",\"name\":{\"kind\":\"Name\",\"value\":\"data\"}}}],\"selectionSet\":{\"kind\":\"SelectionSet\",\"selections\":[{\"kind\":\"Field\",\"name\":{\"kind\":\"Name\",\"value\":\"companyName\"}},{\"kind\":\"Field\",\"name\":{\"kind\":\"Name\",\"value\":\"metrics\"},\"selectionSet\":{\"kind\":\"SelectionSet\",\"selections\":[{\"kind\":\"Field\",\"name\":{\"kind\":\"Name\",\"value\":\"metricsName\"}},{\"kind\":\"Field\",\"name\":{\"kind\":\"Name\",\"value\":\"metricsValues\"}},{\"kind\":\"Field\",\"name\":{\"kind\":\"Name\",\"value\":\"metricsYears\"}}]}}]}},{\"kind\":\"Field\",\"name\":{\"kind\":\"Name\",\"value\":\"calcRoic\"},\"arguments\":[{\"kind\":\"Argument\",\"name\":{\"kind\":\"Name\",\"value\":\"data\"},\"value\":{\"kind\":\"Variable\",\"name\":{\"kind\":\"Name\",\"value\":\"data\"}}}],\"selectionSet\":{\"kind\":\"SelectionSet\",\"selections\":[{\"kind\":\"Field\",\"name\":{\"kind\":\"Name\",\"value\":\"companyName\"}},{\"kind\":\"Field\",\"name\":{\"kind\":\"Name\",\"value\":\"metrics\"},\"selectionSet\":{\"kind\":\"SelectionSet\",\"selections\":[{\"kind\":\"Field\",\"name\":{\"kind\":\"Name\",\"value\":\"metricsName\"}},{\"kind\":\"Field\",\"name\":{\"kind\":\"Name\",\"value\":\"metricsValues\"}},{\"kind\":\"Field\",\"name\":{\"kind\":\"Name\",\"value\":\"metricsYears\"}}]}}]}}]}}]} as unknown as DocumentNode<CalcRoicWaccQuery, CalcRoicWaccQueryVariables>;","import { useTabItems } from \"./hooks/useTabItems\";\nimport React, { useState } from \"react\";\nimport { useMutation, useReactiveVar } from \"@apollo/client\";\nimport Template from \"../template/Template\";\nimport FileUploader from \"../organisms/FileUploader\";\nimport { useHistory } from \"react-router\";\nimport { UploadExcelDocument } from \"../generated/graphql\";\nimport {\n  companySettingVar,\n  isDataLoadedVar,\n  localCompanyDataVar,\n} from \"../store\";\n\nexport type NewFilePresProps = {\n  acceptedFiles: File[];\n  setAcceptedFiles: (files: File[]) => void;\n  handleUpload: () => void;\n  successText?: string;\n  errorText?: string;\n  loading: boolean;\n};\n\nexport const NewFilePres: React.FC<NewFilePresProps> = (props) => {\n  const isDataLoaded = useReactiveVar(isDataLoadedVar);\n  const tabItems = useTabItems(isDataLoaded);\n  return (\n    <Template tabItems={tabItems} tabSelected={1}>\n      <FileUploader {...props} />\n    </Template>\n  );\n};\n\nconst NewFile: React.FC = () => {\n  const [acceptedFiles, setAcceptedFiles] = useState<File[]>([]);\n  const history = useHistory();\n  const [uploadFunc, { data, loading, error }] = useMutation(\n    UploadExcelDocument,\n    {\n      onCompleted(data) {\n        const localData = data.uploadSpeedaExcel?.companyData.map((d) => {\n          const { __typename: __data, ...others } = d;\n          const { __typename: __metrics, ...othersMetrics } = d.metrics;\n          others.metrics = othersMetrics;\n          return others;\n        });\n        localCompanyDataVar(localData);\n        isDataLoadedVar(true);\n        const colors = [\n          \"#4E79A7\",\n          \"#A0CBE8\",\n          \"#F28E2B\",\n          \"#FFBE7D\",\n          \"#59A14F\",\n          \"#8CD17D\",\n          \"#B6992D\",\n          \"#F1CE63\",\n          \"#499894\",\n          \"#86BCB6\",\n          \"#E15759\",\n          \"#FF9D9A\",\n          \"#79706E\",\n          \"#BAB0AC\",\n          \"#D37295\",\n          \"#FABFD2\",\n          \"#B07AA1\",\n          \"#D4A6C8\",\n          \"#9d7660\",\n          \"#D7B5A6\",\n        ];\n        companySettingVar(\n          [...new Set(localData?.map((d) => d.companyName))].map((d, i) => ({\n            name: d,\n            visibility: true,\n            color: colors[i % colors.length],\n          }))\n        );\n        console.info(localData);\n        window.setTimeout(() => history.push(\"/table\"), 800);\n      },\n      onError(error) {\n        console.error(error.message);\n      },\n    }\n  );\n  const handleUpload = async () => {\n    await uploadFunc({ variables: { files: acceptedFiles } });\n  };\n  return (\n    <NewFilePres\n      {...{\n        acceptedFiles,\n        setAcceptedFiles,\n        handleUpload,\n        successText: !!(!error && data)\n          ? `${\n              new Set(\n                data?.uploadSpeedaExcel?.companyData?.map((c) => c.companyName)\n              ).size\n            }社のデータを読み取りました。データ確認画面に遷移します。`\n          : undefined,\n        loading,\n        errorText: error\n          ? `エラーが発生しました(${error.message})。ファイルを確認の上解決しない場合は連絡をください。`\n          : undefined,\n      }}\n    />\n  );\n};\n\nexport default NewFile;\n","import { useState } from \"react\";\n\nexport const useModal = () => {\n  const [modalOpen, setModalOpen] = useState(false);\n  const handleModalOpen = () => setModalOpen(true);\n  const handleModalClose = () => setModalOpen(false);\n  return { modalOpen, handleModalOpen, handleModalClose };\n};\n","import { useQuery } from \"@apollo/client\";\nimport { useState } from \"react\";\nimport {\n  CalcRoicWaccDocument,\n  GetLocalDataDocument,\n  CompanyData,\n} from \"../../generated/graphql\";\n\nexport const useRoicWacc = (onComplete?: (data: CompanyData[]) => void) => {\n  const [data, setData] = useState<CompanyData[]>([]);\n  // ローカルに保存されたエクセル読み取り結果を引っ張る\n  useQuery(GetLocalDataDocument, {\n    onCompleted: async (queryResponse) => {\n      const localCompanyData = queryResponse.localCompanyData;\n      setData(localCompanyData);\n      // ROIC計算を行う\n      await refetchRoic({ data: localCompanyData });\n      onComplete && onComplete(localCompanyData);\n    },\n  });\n  // ROICやドライバを計算するクエリ\n  const { refetch: refetchRoic, loading, error } = useQuery(\n    CalcRoicWaccDocument,\n    {\n      // ローカルの状態を読み込むまではとりあえず空配列を投げる\n      variables: { data: [] },\n      onCompleted: (queryResponse) => {\n        // 既存データに取得したデータをマージして企業名称でソートをする\n        setData((prevData) =>\n          [\n            ...prevData,\n            ...queryResponse.calcRoic,\n            ...queryResponse.calcDrivers,\n          ].sort((a, b) =>\n            a.companyName === b.companyName\n              ? 0\n              : a.companyName > b.companyName\n              ? 1\n              : -1\n          )\n        );\n      },\n      // TODO: Error処理。バックエンド側も実装必要。 Issue #3\n      onError: (err) => console.error(err),\n    }\n  );\n  return { data, loading, error };\n};\n","import { CompanyData } from \"../generated/graphql\";\nimport { Data } from \"plotly.js\";\nexport function toTableColumn(\n  data: CompanyData[],\n  filter: string[] | undefined = undefined\n) {\n  const columns = [\n    \"企業名称\",\n    \"年度\",\n    ...new Set(data.map((d) => d.metrics.metricsName)),\n  ].map((c) => ({ key: c, name: c }));\n  if (filter) {\n    return columns.filter((x) => ![...filter].includes(x.key));\n  } else {\n    return columns;\n  }\n}\n\nexport function toTableRow(data: CompanyData[]) {\n  /*\n   フロントエンドにこの複雑なロジックがあるのはあまりイケていない気がしている\n   ただバックエンドに流すとしてもデータ構造（不特定のキーのObjectのList）がGraphQLと嚙み合わないので、\n   文字列でもらってJSON.parseするそれはそれでイケていないやり方になる\n   そもそもGraphQLと今回の要件が嚙み合わない気もする\n  */\n  const yearCompanyMap = new Map(\n    [\n      ...new Set(\n        data.flatMap((d) =>\n          d.metrics.metricsYears.reduce(\n            (prev, year) => [\n              ...prev,\n              JSON.stringify({\n                year: year,\n                companyName: d.companyName,\n              }),\n            ],\n            [] as string[]\n          )\n        )\n      ),\n    ].map((t) => [t, [] as { [key: string]: any }[]])\n  );\n  data.forEach((d) =>\n    d.metrics.metricsYears.forEach((year, i) => {\n      yearCompanyMap\n        .get(JSON.stringify({ year: year, companyName: d.companyName }))\n        ?.push({ [d.metrics.metricsName]: d.metrics.metricsValues[i] });\n    })\n  );\n  const rows = [] as { [key: string]: any }[];\n  yearCompanyMap.forEach((value, key) => {\n    const row = value.reduce((prev, current) => {\n      return Object.assign(prev, current);\n    }, {});\n    const yearCompanyName = JSON.parse(key);\n    Object.assign(row, {\n      企業名称: yearCompanyName.companyName,\n      年度: yearCompanyName.year,\n    });\n    rows.push(row);\n  });\n  return rows;\n}\n\nexport function toScatterData(\n  data: CompanyData[],\n  x: string,\n  y: string,\n  yearIndex: number,\n  companyColor: { [company: string]: number | string }\n): Data[] {\n  const companies = [...new Set(data.map((d) => d.companyName))];\n  const xAxisData = data\n    .filter((d) => d.metrics.metricsName === x)\n    .reduce(\n      (prev, current) =>\n        prev.set(current.companyName, current.metrics.metricsValues[yearIndex]),\n      new Map()\n    );\n  const yAxisData = data\n    .filter((d) => d.metrics.metricsName === y)\n    .reduce(\n      (prev, current) =>\n        prev.set(current.companyName, current.metrics.metricsValues[yearIndex]),\n      new Map()\n    );\n  return companies.map((company) => ({\n    x: [xAxisData.get(company)],\n    y: [yAxisData.get(company)],\n    type: \"scatter\",\n    mode: \"text+markers\",\n    name: company,\n    text: company,\n    textposition: \"top center\",\n    marker: { size: 15, color: companyColor[company] },\n  }));\n}\n\nexport function toTreeData(\n  data: CompanyData[],\n  companyColor: { [company: string]: number | string }\n): Data[] {\n  const metrics_position: {\n    [metric: string]: { xaxis: string; yaxis: string };\n  } = {\n    ROIC: { xaxis: \"x\", yaxis: \"y\" },\n    投下資本回転率: { xaxis: \"x2\", yaxis: \"y2\" },\n    NOPATマージン: { xaxis: \"x2\", yaxis: \"y3\" },\n    固定資産回転率: { xaxis: \"x3\", yaxis: \"y4\" },\n    運転資本回転率: { xaxis: \"x3\", yaxis: \"y5\" },\n    販管費率: { xaxis: \"x3\", yaxis: \"y6\" },\n    売上原価率: { xaxis: \"x3\", yaxis: \"y7\" },\n  };\n  return [\n    \"ROIC\",\n    \"投下資本回転率\",\n    \"NOPATマージン\",\n    \"固定資産回転率\",\n    \"運転資本回転率\",\n    \"販管費率\",\n    \"売上原価率\",\n  ].flatMap((metricsName) =>\n    data\n      .filter((d) => d.metrics.metricsName === metricsName)\n      .map((d) => ({\n        x: d.metrics.metricsYears,\n        y: d.metrics.metricsValues,\n        type: \"scatter\",\n        mode: \"lines+markers\",\n        name: d.companyName,\n        legendgroup: d.companyName,\n        showlegend: d.metrics.metricsName === \"ROIC\",\n        xaxis: metrics_position[d.metrics.metricsName].xaxis,\n        yaxis: metrics_position[d.metrics.metricsName].yaxis,\n        marker: { color: companyColor[d.companyName] },\n      }))\n  );\n}\n","import { CheckBox, CheckBoxOutlineBlank } from \"@mui/icons-material\";\nimport {\n  Button,\n  List,\n  ListItem,\n  ListItemIcon,\n  ListItemText,\n  Modal,\n  ModalProps,\n  Typography,\n} from \"@mui/material\";\nimport { useCallback } from \"react\";\nimport styled from \"styled-components\";\n\nexport type ColumnFilterModalProps = {\n  columns: string[];\n  filter: string[] | undefined;\n  handleFilterChange: (col: string | string[]) => void;\n  open: boolean;\n  onClose: ModalProps[\"onClose\"];\n};\nconst ModalContent = styled.div`\n  background-color: white;\n  position: absolute;\n  top: 30%;\n  left: 50%;\n  transform: translate(-50%, -30%);\n  width: 50%;\n  max-height: 50%;\n  overflow: scroll;\n`;\nconst FlexContainer = styled.div`\n  display: flex;\n  column-gap: 10px;\n  align-items: center;\n`;\nconst ColumnFilterModal: React.FC<ColumnFilterModalProps> = (props) => {\n  const handleAllUncheck = useCallback(() => {\n    props.handleFilterChange(props.columns);\n  }, [props]);\n  const handleAllCheck = useCallback(() => {\n    props.handleFilterChange([]);\n  }, [props]);\n  return (\n    <Modal open={props.open} onClose={props.onClose}>\n      <ModalContent>\n        <FlexContainer>\n          <Typography>表示するカラムを選択</Typography>\n          <Button variant=\"contained\" onClick={handleAllCheck}>\n            全選択\n          </Button>\n          <Button variant=\"contained\" onClick={handleAllUncheck}>\n            全解除\n          </Button>\n        </FlexContainer>\n        <List>\n          {props.columns.map((col) => (\n            <ListItem onClick={(e) => props.handleFilterChange(col)} key={col}>\n              <ListItemIcon>\n                {props.filter && props.filter.includes(col) ? (\n                  <CheckBoxOutlineBlank />\n                ) : (\n                  <CheckBox />\n                )}\n              </ListItemIcon>\n              <ListItemText primary={col} />\n            </ListItem>\n          ))}\n        </List>\n      </ModalContent>\n    </Modal>\n  );\n};\nexport default ColumnFilterModal;\n","import Template from \"../template/Template\";\nimport { useRoicWacc, useTabItems, useModal } from \"./hooks\";\nimport DataGrid from \"react-data-grid\";\nimport { useMemo, useState } from \"react\";\nimport rowGrouper from \"lodash.groupby\";\nimport { toTableColumn, toTableRow } from \"../util/dataTransform\";\nimport { Button } from \"@mui/material\";\nimport { Save, PermDataSetting } from \"@mui/icons-material\";\nimport styled from \"styled-components\";\nimport ColumnFilterModal from \"../organisms/ColumnFilterModal\";\nimport { createCsvString } from \"../util/createCsvString\";\n\nconst ButtonContainer = styled.div`\n  display: flex;\n  justify-content: flex-end;\n  margin: 10px 0;\n  column-gap: 10px;\n`;\nconst Table: React.FC = () => {\n  const tabItems = useTabItems();\n  // データの読み出しと計算\n  const { data: tableData, loading, error } = useRoicWacc((data) =>\n    setExpandedGroupIds(new Set(data.map((d) => d.companyName)))\n  );\n  //　モーダル関連\n  const { modalOpen, handleModalOpen, handleModalClose } = useModal();\n  // テーブル関連\n  // テーブルの折りたたみ\n  const [expandedGroupIds, setExpandedGroupIds] = useState<\n    ReadonlySet<unknown>\n  >(new Set());\n  // テーブルの行列を作る\n  const rows = useMemo(() => toTableRow(tableData), [tableData]);\n  const allColumns = useMemo(\n    () =>\n      toTableColumn(tableData).filter(\n        (x) => x.key !== \"企業名称\" && x.key !== \"年度\"\n      ),\n    [tableData]\n  );\n  const [columnFilter, setColumnFilter] = useState<string[] | undefined>();\n  const handleFilterChange = (column: string | string[]) => {\n    if (typeof column === \"string\") {\n      setColumnFilter((prev) => {\n        if (prev) {\n          if (prev.includes(column)) {\n            return prev.filter((f) => f !== column);\n          } else {\n            return [...prev, column];\n          }\n        } else {\n          return [column];\n        }\n      });\n    } else {\n      setColumnFilter(column);\n    }\n  };\n  const filteredColumns = useMemo(\n    () => toTableColumn(tableData, columnFilter),\n    [columnFilter, tableData]\n  );\n  // CSVダウンロード\n  const handleDownloadClick = () => {\n    const csvString = createCsvString(rows, filteredColumns);\n    const bom = new Uint8Array([0xef, 0xbb, 0xbf]);\n    const blob = new Blob([bom, csvString], { type: \"text/csv\" });\n    const url = window.URL.createObjectURL(blob);\n    const a = document.createElement(\"a\");\n    a.href = url;\n    a.download = \"QuickRoicOutput.csv\";\n    a.click();\n    a.remove();\n  };\n  return (\n    <Template\n      tabItems={tabItems}\n      tabSelected={2}\n      loading={loading}\n      error={error}\n    >\n      <ColumnFilterModal\n        handleFilterChange={handleFilterChange}\n        open={modalOpen}\n        columns={allColumns.map((c) => c.name)}\n        filter={columnFilter}\n        onClose={handleModalClose}\n      />\n      <ButtonContainer>\n        <Button\n          startIcon={<PermDataSetting />}\n          variant=\"contained\"\n          color=\"secondary\"\n          onClick={handleModalOpen}\n        >\n          表示カラムの設定\n        </Button>\n        <Button\n          startIcon={<Save />}\n          variant=\"contained\"\n          onClick={handleDownloadClick}\n        >\n          Download As CSV\n        </Button>\n      </ButtonContainer>\n      <DataGrid\n        rows={rows}\n        columns={filteredColumns}\n        style={{ height: \"75vh\" }}\n        groupBy={[\"企業名称\"]}\n        rowGrouper={rowGrouper}\n        className=\"rdg-light\"\n        expandedGroupIds={expandedGroupIds}\n        onExpandedGroupIdsChange={setExpandedGroupIds}\n        defaultColumnOptions={{ resizable: true }}\n      />\n    </Template>\n  );\n};\nexport default Table;\n","export function createCsvString(\n  rows: { [key: string]: any }[],\n  columns: { key: string }[]\n) {\n  const lines = [\n    columns.map((c) => c.key).join(\",\"),\n    ...rows.map((row) =>\n      columns\n        .reduce((prev, current) => (prev += row[current.key] + \",\"), \"\")\n        .slice(0, -1)\n    ),\n  ];\n  return lines.join(\"\\n\");\n}\n","import React, { useMemo, useState } from \"react\";\nimport Template from \"../template/Template\";\nimport { useRoicWacc, useTabItems, useIntervalFunc } from \"./hooks\";\nimport Plot from \"react-plotly.js\";\nimport { Layout } from \"plotly.js\";\nimport { toScatterData } from \"../util/dataTransform\";\nimport {\n  Grid,\n  IconButton,\n  ToggleButton,\n  ToggleButtonGroup,\n  Typography,\n} from \"@mui/material\";\nimport { SxProps } from \"@mui/system\";\nimport { PlayArrow, Stop } from \"@mui/icons-material\";\nimport { companySettingVar } from \"../store\";\nimport { useReactiveVar } from \"@apollo/client\";\n\nconst Scatter: React.FC = () => {\n  const tabItems = useTabItems();\n  const [yearIndex, setYearIndex] = useState(0);\n  const { isActive: isYearMoving, toggleInterval } = useIntervalFunc(() => {\n    setYearIndex((y) => {\n      if (y === data[0].metrics.metricsYears.length - 2) {\n        return 0;\n      }\n      return y + 1;\n    });\n  }, 1000);\n  const { data, loading, error } = useRoicWacc((data) => {\n    setYearIndex(data[0].metrics.metricsYears.length - 2);\n  });\n  const companySetting = useReactiveVar(companySettingVar);\n  const companyColor = useMemo<{ [key: string]: string }>(\n    () =>\n      companySetting.reduce(\n        (prev, setting) =>\n          Object.assign(prev, { [setting.name]: setting.color }),\n        {}\n      ),\n    [companySetting]\n  );\n  const companyVisibility = useMemo<{ [key: string]: string }>(\n    () =>\n      companySetting.reduce(\n        (prev, setting) =>\n          Object.assign(prev, { [setting.name]: setting.visibility }),\n        {}\n      ),\n    [companySetting]\n  );\n  const roicWaccData = useMemo(\n    () =>\n      toScatterData(\n        data.filter((d) => companyVisibility[d.companyName]),\n        \"ROIC\",\n        \"WACC\",\n        yearIndex,\n        companyColor\n      ),\n    [companyColor, companyVisibility, data, yearIndex]\n  );\n  const roicWaccLayout: Partial<Layout> = {\n    showlegend: false,\n    title: {\n      text: \"WACC-ROICプロット\",\n    },\n    xaxis: {\n      title: \"ROIC\",\n      rangemode: \"tozero\",\n      tickformat: \",.1%\",\n    },\n    yaxis: {\n      title: \"WACC\",\n      rangemode: \"tozero\",\n      tickformat: \",.1%\",\n    },\n    shapes: [\n      {\n        type: \"line\",\n        x0: 0,\n        y0: 0,\n        // TODO: ROICとWACCのマックスを設定する Issue #2\n        x1: 0.2,\n        y1: 0.2,\n        xref: \"x\",\n        yref: \"y\",\n        line: {\n          width: 1,\n          dash: \"dot\",\n        },\n      },\n    ],\n  };\n  const nopatCapitalData = useMemo(\n    () =>\n      toScatterData(\n        data.filter((d) => companyVisibility[d.companyName]),\n        \"NOPATマージン\",\n        \"投下資本回転率\",\n        yearIndex,\n        companyColor\n      ),\n    [companyColor, companyVisibility, data, yearIndex]\n  );\n  const nopatCapitalLayout: Partial<Layout> = {\n    showlegend: false,\n    title: {\n      text: \"NOPATマージン-投下資本回転率プロット\",\n    },\n    xaxis: {\n      title: \"NOPATマージン\",\n      rangemode: \"tozero\",\n      tickformat: \",.1%\",\n    },\n    yaxis: {\n      title: \"投下資本回転率\",\n      rangemode: \"tozero\",\n      tickformat: \",.1%\",\n    },\n  };\n  const gridSx: SxProps = { display: \"flex\", justifyContent: \"center\" };\n  return (\n    <Template\n      tabItems={tabItems}\n      tabSelected={3}\n      loading={loading}\n      error={error}\n    >\n      {data && data.length > 0 && (\n        <>\n          <Grid container sx={gridSx}>\n            <Grid item md={6} sm={12} sx={gridSx}>\n              <Plot data={roicWaccData} layout={roicWaccLayout} />\n            </Grid>\n            <Grid item md={6} sm={12} sx={gridSx}>\n              <Plot data={nopatCapitalData} layout={nopatCapitalLayout} />\n            </Grid>\n          </Grid>\n          <Grid container sx={{ columnGap: 2, alignItems: \"center\" }}>\n            <Typography\n              variant=\"body1\"\n              sx={{\n                display: \"flex\",\n                justifyContent: \"center\",\n                alignItems: \"center\",\n              }}\n            >\n              表示年度\n            </Typography>\n            <ToggleButtonGroup\n              color=\"primary\"\n              value={data[0].metrics.metricsYears[yearIndex + 1]}\n            >\n              {data[0].metrics.metricsYears\n                .filter((y, i) => i !== 0)\n                .map((y, i) => (\n                  <ToggleButton\n                    value={y}\n                    key={y}\n                    onClick={() => {\n                      setYearIndex(i);\n                    }}\n                  >\n                    {y}\n                  </ToggleButton>\n                ))}\n            </ToggleButtonGroup>\n            <IconButton color=\"primary\" onClick={() => toggleInterval()}>\n              {isYearMoving ? <Stop /> : <PlayArrow />}\n            </IconButton>\n          </Grid>\n        </>\n      )}\n    </Template>\n  );\n};\nexport default Scatter;\n","import { useCallback, useState } from \"react\";\n\nexport const useIntervalFunc = (func: () => void, interval: number) => {\n  const [isActive, setIsActive] = useState(false);\n  const [intervalId, setIntervalId] = useState<number | undefined>(undefined);\n  const startInterval = useCallback(() => {\n    if (isActive) {\n      return;\n    }\n    const id = window.setInterval(func, interval);\n    setIsActive(true);\n    setIntervalId(id);\n  }, [func, interval, isActive]);\n  const stopInterval = useCallback(() => {\n    window.clearInterval(intervalId);\n    setIsActive(false);\n    setIntervalId(undefined);\n  }, [intervalId]);\n  const toggleInterval = useCallback(() => {\n    if (isActive) {\n      stopInterval();\n    } else {\n      startInterval();\n    }\n  }, [isActive, startInterval, stopInterval]);\n  return { isActive, startInterval, stopInterval, toggleInterval };\n};\n","import { Layout } from \"plotly.js\";\nimport { useMemo } from \"react\";\nimport Plot from \"react-plotly.js\";\nimport Template from \"../template/Template\";\nimport { useRoicWacc, useTabItems } from \"./hooks\";\nimport { toTreeData } from \"../util/dataTransform\";\nimport { useReactiveVar } from \"@apollo/client\";\nimport { companySettingVar } from \"../store\";\n\nconst Tree: React.FC = () => {\n  const tabItems = useTabItems();\n  const { data, loading, error } = useRoicWacc();\n  const companySetting = useReactiveVar(companySettingVar);\n  const companyColor = useMemo<{ [key: string]: string }>(\n    () =>\n      companySetting.reduce(\n        (prev, setting) =>\n          Object.assign(prev, { [setting.name]: setting.color }),\n        {}\n      ),\n    [companySetting]\n  );\n  const companyVisibility = useMemo<{ [key: string]: string }>(\n    () =>\n      companySetting.reduce(\n        (prev, setting) =>\n          Object.assign(prev, { [setting.name]: setting.visibility }),\n        {}\n      ),\n    [companySetting]\n  );\n  const layout: Partial<Layout> = {\n    annotations: [\n      {\n        text: \"ROIC\",\n        showarrow: false,\n        align: \"center\",\n        x: 0.135,\n        y: 1.1,\n        xref: \"paper\",\n        yref: \"paper\",\n      },\n      {\n        text: \"NOPATマージン\",\n        showarrow: false,\n        align: \"center\",\n        x: 0.5,\n        y: 1.1,\n        xref: \"paper\",\n        yref: \"paper\",\n      },\n      {\n        text: \"投下資本回転率\",\n        showarrow: false,\n        align: \"center\",\n        x: 0.5,\n        y: 0.5,\n        xref: \"paper\",\n        yref: \"paper\",\n      },\n      {\n        text: \"売上原価率\",\n        showarrow: false,\n        x: 0.868,\n        y: 1.1,\n        xref: \"paper\",\n        yref: \"paper\",\n      },\n      {\n        text: \"販管費率\",\n        showarrow: false,\n        x: 0.865,\n        y: 0.82,\n        xref: \"paper\",\n        yref: \"paper\",\n      },\n      {\n        text: \"運転資本回転率\",\n        showarrow: false,\n        align: \"center\",\n        x: 0.88,\n        y: 0.5,\n        xref: \"paper\",\n        yref: \"paper\",\n      },\n      {\n        text: \"固定資産回転率\",\n        showarrow: false,\n        align: \"center\",\n        x: 0.88,\n        y: 0.2,\n        xref: \"paper\",\n        yref: \"paper\",\n      },\n    ],\n    xaxis: {\n      domain: [0, 0.3],\n      anchor: \"y\",\n    },\n    xaxis2: {\n      domain: [0.3 + 0.1 / 2, 0.6 + 0.1 / 2],\n      anchor: \"y2\",\n    },\n    xaxis3: {\n      domain: [0.7, 1.0],\n      anchor: \"y4\",\n    },\n    yaxis: {\n      domain: [0, 1],\n      tickformat: \",.0%\",\n      anchor: \"x\",\n    },\n    yaxis2: {\n      domain: [0, 0.45],\n      anchor: \"x2\",\n    },\n    yaxis3: {\n      domain: [0.55, 1],\n      tickformat: \",.0%\",\n      anchor: \"x2\",\n    },\n    yaxis4: {\n      domain: [0, 0.35 / 2],\n      anchor: \"x3\",\n    },\n    yaxis5: {\n      domain: [0.45 - 0.35 / 2, 0.45],\n      anchor: \"x3\",\n    },\n    yaxis6: {\n      domain: [0.585, 0.585 + 0.35 / 2],\n      tickformat: \",.0%\",\n      anchor: \"x3\",\n    },\n    yaxis7: {\n      domain: [1 - 0.35 / 2, 1.0],\n      tickformat: \",.0%\",\n\n      anchor: \"x3\",\n    },\n    showlegend: true,\n    legend: { orientation: \"h\" },\n  };\n  const roicData = useMemo(\n    () =>\n      toTreeData(\n        data.filter((d) => companyVisibility[d.companyName]),\n        companyColor\n      ),\n    [companyColor, companyVisibility, data]\n  );\n  return (\n    <Template\n      tabItems={tabItems}\n      tabSelected={4}\n      loading={loading}\n      error={error}\n    >\n      {data && (\n        <Plot\n          style={{ width: \"100%\", height: \"80vh\" }}\n          data={roicData}\n          layout={layout}\n          config={{ responsive: false }}\n        />\n      )}\n    </Template>\n  );\n};\nexport default Tree;\n","import { Visibility, VisibilityOff } from \"@mui/icons-material\";\nimport { Chip, List, ListItem, Modal } from \"@mui/material\";\nimport { useState } from \"react\";\nimport { SketchPicker, SketchPickerProps } from \"react-color\";\nimport { useModal } from \"../page/hooks\";\n\nexport type CompanySettingProps = {\n  companies: {\n    name: string;\n    color: string;\n    visibility: boolean;\n    setVisibility: (visibility: boolean) => void;\n    setColor: (color: string) => void;\n  }[];\n};\nfunction blackOrWhite(hexColor: string): string {\n  const r = parseInt(hexColor.substr(1, 2), 16);\n  const g = parseInt(hexColor.substr(3, 2), 16);\n  const b = parseInt(hexColor.substr(5, 2), 16);\n  return (r * 299 + g * 587 + b * 114) / 1000 < 128 ? \"white\" : \"black\";\n}\nconst CompanySetting: React.FC<CompanySettingProps> = (props) => {\n  const { modalOpen, handleModalOpen, handleModalClose } = useModal();\n  // react-colorに表示している色\n  const [color, setColor] = useState(\"#ffffff\");\n  const handleColorChange: SketchPickerProps[\"onChange\"] = (color, _) => {\n    setColor(color.hex);\n    props.companies[focusedCompanyIndex].setColor(color.hex);\n  };\n  // react-colorで変更する対象の企業の色変更のハンドラ\n  const [focusedCompanyIndex, setFocusedCompanyIndex] = useState(0);\n  return (\n    <>\n      <List>\n        {props.companies.map((c, i) => (\n          <ListItem key={c.name}>\n            <Chip\n              label={c.name}\n              onClick={() => {\n                handleModalOpen();\n                setColor(c.color);\n                setFocusedCompanyIndex(i);\n              }}\n              onDelete={() => c.setVisibility(!c.visibility)}\n              deleteIcon={c.visibility ? <Visibility /> : <VisibilityOff />}\n              sx={{\n                background: c.visibility ? c.color : \"silver\",\n                color: c.visibility ? blackOrWhite(c.color) : \"black\",\n              }}\n            />\n          </ListItem>\n        ))}\n      </List>\n      <Modal open={modalOpen} onClose={handleModalClose}>\n        <div\n          style={{\n            position: \"absolute\" as \"absolute\",\n            top: \"50%\",\n            left: \"50%\",\n            transform: \"translate(-50%, -50%)\",\n          }}\n        >\n          <SketchPicker color={color} onChange={handleColorChange} />\n        </div>\n      </Modal>\n    </>\n  );\n};\nexport default CompanySetting;\n","import { Typography } from \"@mui/material\";\nimport CompanySetting from \"../organisms/CompanySetting\";\nimport Template from \"../template/Template\";\nimport { useCompanySettings, useTabItems } from \"./hooks\";\n\nconst Setting: React.FC = () => {\n  const tabItems = useTabItems(true);\n  const companySetting = useCompanySettings();\n  return (\n    <Template tabItems={tabItems} tabSelected={5}>\n      <Typography variant=\"h6\">企業の表示設定</Typography>\n      <CompanySetting companies={companySetting} />\n    </Template>\n  );\n};\nexport default Setting;\n","import { useReactiveVar } from \"@apollo/client\";\nimport { companySettingVar } from \"../../store\";\nimport { useMemo } from \"react\";\nimport { CompanySettingProps } from \"../../organisms/CompanySetting\";\n\nexport const useCompanySettings = () => {\n  const companySettings = useReactiveVar(companySettingVar);\n  const companiesSettingProps = useMemo<CompanySettingProps[\"companies\"]>(\n    () =>\n      companySettings.map((company, index) => ({\n        setColor: (color) => {\n          companySettingVar([\n            ...companySettings.slice(0, index),\n            { ...company, color },\n            ...(index === companySettings.length - 1\n              ? []\n              : companySettings.slice(index + 1)),\n          ]);\n        },\n        setVisibility: (visibility) => {\n          companySettingVar([\n            ...companySettings.slice(0, index),\n            { ...company, visibility },\n            ...(index === companySettings.length - 1\n              ? []\n              : companySettings.slice(index + 1)),\n          ]);\n        },\n        ...company,\n      })),\n    [companySettings]\n  );\n  return companiesSettingProps;\n};\n","import { BrowserRouter, Route, Switch } from \"react-router-dom\";\nimport { ThemeProvider as SsThemeProvider } from \"styled-components\";\nimport {\n  ThemeProvider as MuiThemeProvider,\n  StyledEngineProvider,\n} from \"@mui/material/styles\";\nimport theme from \"./theme\";\nimport Home from \"./page/Home\";\nimport NewFile from \"./page/NewFile\";\nimport Table from \"./page/Table\";\nimport Scatter from \"./page/Scatter\";\nimport Tree from \"./page/Tree\";\nimport { ReactElement } from \"react\";\nimport Setting from \"./page/Setting\";\n\nconst Providers: React.FC = (props) => (\n  <BrowserRouter basename={process.env.PUBLIC_URL}>\n    <StyledEngineProvider injectFirst>\n      <MuiThemeProvider theme={theme}>\n        <SsThemeProvider theme={theme}>{props.children}</SsThemeProvider>\n      </MuiThemeProvider>\n    </StyledEngineProvider>\n  </BrowserRouter>\n);\nconst routing: { path: string; component: ReactElement }[] = [\n  {\n    path: \"/\",\n    component: <Home />,\n  },\n  {\n    path: \"/new\",\n    component: <NewFile />,\n  },\n  {\n    path: \"/table\",\n    component: <Table />,\n  },\n  {\n    path: \"/scatter\",\n    component: <Scatter />,\n  },\n  {\n    path: \"/tree\",\n    component: <Tree />,\n  },\n  {\n    path: \"/setting\",\n    component: <Setting />,\n  },\n];\nfunction App() {\n  return (\n    <Providers>\n      <Switch>\n        {routing.map((r) => (\n          <Route path={r.path} exact>\n            {r.component}\n          </Route>\n        ))}\n      </Switch>\n    </Providers>\n  );\n}\n\nexport default App;\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\nimport reportWebVitals from \"./reportWebVitals\";\nimport \"./index.css\";\nimport { ApolloProvider, ApolloClient, InMemoryCache } from \"@apollo/client\";\nimport { createUploadLink } from \"apollo-upload-client\";\nimport { typePolicies, typeDefs } from \"./store\";\n\nconst link = createUploadLink({ uri: process.env.REACT_APP_GRAPHQL_ENDPOINT });\nconst client = new ApolloClient({\n  link: link,\n  typeDefs,\n  cache: new InMemoryCache({\n    typePolicies,\n  }),\n});\n\nReactDOM.render(\n  <React.StrictMode>\n    <ApolloProvider client={client}>\n      <App />\n    </ApolloProvider>\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}